{
  "data": "# 系统架构文档\n\n## 1. 架构概览 (Architecture Overview)\n\n### 1.1 架构设计理念\n\n占卜应用采用现代React前端架构设计，以组件化和分层架构为核心理念，构建了一个高度模块化、可维护性强的移动端神秘学服务平台。整体架构设计遵循单一职责原则、开闭原则和依赖倒置原则，确保系统具备良好的可扩展性和可维护性。\n\n架构设计的核心理念包括：\n- **组件化设计**：将功能模块拆分为独立的可复用组件，降低系统耦合度\n- **分层架构**：采用清晰的分层结构，实现职责分离和关注点分离\n- **响应式设计**：适配移动端设备，提供一致的用户体验\n- **可扩展性**：预留扩展接口，支持未来功能迭代和业务扩展\n\n### 1.2 核心架构模式\n\n系统采用**组件化架构模式**结合**分层设计模式**，形成了四层架构体系：\n\n1. **应用层**：App.tsx作为应用主容器，负责页面导航和状态管理\n2. **业务领域层**：占卜、风水、社区、个人中心四大核心功能模块\n3. **UI组件支撑层**：基于Radix UI构建的通用UI组件库\n4. **基础支撑层**：工具函数、图片处理等基础功能组件\n\n### 1.3 技术栈概述\n\n- **前端框架**：React 18（函数组件 + Hooks）\n- **编程语言**：TypeScript（强类型支持）\n- **样式框架**：Tailwind CSS（原子化CSS）\n- **UI组件库**：Radix UI（无障碍设计）、Lucide React（图标库）\n- **构建工具**：Vite（快速构建）\n- **状态管理**：React Hooks（局部状态管理）\n- **表单处理**：react-hook-form（表单验证）\n\n```mermaid\ngraph TB\n    subgraph \"应用层\"\n        A[App.tsx] --> D[DivinationPage.tsx]\n        A --> F[FengShuiPage.tsx]\n        A --> C[CommunityPage.tsx]\n        A --> P[ProfilePage.tsx]\n    end\n\n    subgraph \"业务领域层\"\n        D --> D1[占卜领域]\n        F --> F1[风水领域]\n        C --> C1[社区领域]\n        P --> P1[个人中心领域]\n    end\n\n    subgraph \"UI组件支撑层\"\n        UI[UI组件库] --> B[Button组件]\n        UI --> Card[Card组件]\n        UI --> Input[Input组件]\n        UI --> Progress[Progress组件]\n        UI --> Dialog[Dialog组件]\n        UI --> Dropdown[Dropdown组件]\n        UI --> Tabs[Tabs组件]\n    end\n\n    subgraph \"基础支撑层\"\n        Fallback[ImageWithFallback.tsx]\n        Utils[utils.ts]\n        Main[main.tsx]\n    end\n\n    D1 -.-> UI\n    F1 -.-> UI\n    C1 -.-> UI\n    P1 -.-> UI\n\n    A --> Main\n    D --> Fallback\n    F --> Fallback\n    C --> Fallback\n\n    classDef appLayer fill:#e1f5fe\n    classDef businessLayer fill:#f3e5f5\n    classDef uiLayer fill:#e8f5e8\n    classDef baseLayer fill:#fff3e0\n\n    class A,D,F,C,P appLayer\n    class D1,F1,C1,P1 businessLayer\n    class UI,B,Card,Input,Progress,Dialog,Dropdown,Tabs uiLayer\n    class Fallback,Utils,Main baseLayer\n```\n\n## 2. 系统上下文 (System Context)\n\n### 2.1 系统定位与价值\n\n占卜应用是一个专注于神秘学服务的移动端平台，为对占卜、风水等神秘学感兴趣的用户提供便捷的占卜服务体验。系统通过提供星座运势、卡牌占卜、风水方位建议、社区互动等玄学服务，满足用户获取运势指导、生活建议和社区互动的需求。\n\n**业务价值**：\n- 为用户提供个性化的占卜服务和运势指导\n- 构建神秘学爱好者交流的社区平台\n- 提供专业的风水咨询和家居布局建议\n- 建立用户成长体系和成就系统\n\n### 2.2 用户角色与场景\n\n#### 2.2.1 占卜爱好者\n- **用户特征**：对星座运势、卡牌占卜等占卜服务感兴趣\n- **核心需求**：获取准确的占卜结果、简单易用的操作界面、丰富的占卜功能\n- **使用场景**：每日查看星座运势、进行卡牌占卜、记录占卜历史\n\n#### 2.2.2 风水咨询者\n- **用户特征**：希望通过风水知识改善生活质量\n- **核心需求**：获取风水建议、了解方位布局、改善家居环境\n- **使用场景**：查看风水罗盘、获取方位运势、了解家居风水建议\n\n#### 2.2.3 社区用户\n- **用户特征**：希望在神秘学领域与其他用户交流互动\n- **核心需求**：社区互动、经验分享、达人咨询\n- **使用场景**：浏览社区动态、参与话题讨论、咨询达人专家\n\n#### 2.2.4 个人用户\n- **用户特征**：关注个人成长和运势变化\n- **核心需求**：个人运势追踪、成就系统、个性化服务\n- **使用场景**：查看个人统计、解锁成就、个性化设置\n\n### 2.3 外部系统交互\n\n当前系统边界内不包含以下外部系统：\n- **后端服务**：用户认证、数据存储、业务逻辑处理\n- **数据库系统**：用户数据、占卜记录、社区内容存储\n- **第三方API服务**：占卜算法、风水数据、社交功能\n- **支付系统**：会员服务、付费功能、虚拟商品交易\n\n### 2.4 系统边界定义\n\n**包含组件**：\n- 占卜功能模块：星座运势、卡牌占卜等核心占卜服务\n- 风水功能模块：风水罗盘、方位运势、家居建议\n- 社区互动模块：社区动态、达人咨询、话题讨论\n- 个人中心模块：用户信息、成就系统、功能设置\n- UI组件库：基础UI组件、高级UI组件、工具函数\n- 导航系统：底部导航栏、页面路由管理\n- 用户界面：响应式设计、深色主题、神秘学色彩\n\n**系统边界**：提供占卜、风水、社区和个人中心四大核心功能的移动端应用\n\n## 3. 容器视图 (Container View)\n\n### 3.1 领域模块划分\n\n系统采用领域驱动设计（DDD）思想，将功能划分为四个核心业务域和一个基础设施域：\n\n#### 3.1.1 占卜领域（核心业务域）\n- **重要性**：9.0/10\n- **复杂度**：7.5/10\n- **职责**：提供星座运势、卡牌占卜等玄学服务功能\n- **子模块**：\n  - 星座运势模块：展示用户星座运势信息，包含综合评分和健康、爱情、事业、财富四个维度的进度条\n  - 卡牌占卜模块：提供卡牌占卜服务，通过占卜卡牌网格展示多种占卜服务入口\n\n#### 3.1.2 风水领域（核心业务域）\n- **重要性**：8.5/10\n- **复杂度**：7.0/10\n- **职责**：提供风水占卜和方位建议功能\n- **子模块**：\n  - 罗盘展示模块：展示风水罗盘图像，提供方位导向功能\n  - 方位运势模块：展示八个方位的风水运势，包括五行属性和摆放建议\n\n#### 3.1.3 社区领域（核心业务域）\n- **重要性**：8.0/10\n- **复杂度**：6.5/10\n- **职责**：提供神秘学社区功能\n- **子模块**：\n  - 社区动态模块：展示社区热门话题和帖子列表\n  - 达人咨询模块：提供达人咨询服务和达人列表展示\n\n#### 3.1.4 个人中心领域（核心业务域）\n- **重要性**：7.5/10\n- **复杂度**：6.0/10\n- **职责**：管理用户个人信息和统计数据\n- **子模块**：\n  - 用户信息模块：展示用户头像、等级和经验值进度\n  - 成就统计模块：展示用户统计数据和成就系统\n  - 功能设置模块：提供各项功能菜单和系统设置选项\n\n#### 3.1.5 UI组件支撑域（基础设施域）\n- **重要性**：9.0/10\n- **复杂度**：8.5/10\n- **职责**：提供通用UI组件库\n- **子模块**：\n  - 基础UI组件：包含按钮、卡片、输入框等基础UI组件\n  - 高级UI组件：包含对话框、下拉菜单、标签页等高级UI组件\n\n### 3.2 领域模块架构\n\n```mermaid\ngraph TB\n    subgraph \"应用容器\"\n        App[App.tsx<br/>应用主容器]\n    end\n\n    subgraph \"占卜领域容器\"\n        Divination[DivinationPage.tsx<br/>占卜功能模块]\n        subgraph \"占卜子模块\"\n            Star[星座运势模块]\n            Card[卡牌占卜模块]\n        end\n    end\n\n    subgraph \"风水领域容器\"\n        FengShui[FengShuiPage.tsx<br/>风水功能模块]\n        subgraph \"风水子模块\"\n            Compass[罗盘展示模块]\n            Direction[方位运势模块]\n        end\n    end\n\n    subgraph \"社区领域容器\"\n        Community[CommunityPage.tsx<br/>社区功能模块]\n        subgraph \"社区子模块\"\n            Dynamic[社区动态模块]\n            Expert[达人咨询模块]\n        end\n    end\n\n    subgraph \"个人中心领域容器\"\n        Profile[ProfilePage.tsx<br/>个人中心模块]\n        subgraph \"个人中心子模块\"\n            User[用户信息模块]\n            Achievement[成就统计模块]\n            Setting[功能设置模块]\n        end\n    end\n\n    subgraph \"UI组件支撑容器\"\n        UI[UI组件库<br/>基于Radix UI]\n        subgraph \"基础组件\"\n            Button[Button组件]\n            CardUI[Card组件]\n            Input[Input组件]\n            Progress[Progress组件]\n        end\n        subgraph \"高级组件\"\n            Dialog[Dialog组件]\n            Dropdown[Dropdown组件]\n            Tabs[Tabs组件]\n        end\n    end\n\n    subgraph \"基础支撑容器\"\n        Fallback[ImageWithFallback.tsx]\n        Utils[utils.ts]\n        Main[main.tsx]\n    end\n\n    App --> Divination\n    App --> FengShui\n    App --> Community\n    App --> Profile\n\n    Divination --> Star\n    Divination --> Card\n    FengShui --> Compass\n    FengShui --> Direction\n    Community --> Dynamic\n    Community --> Expert\n    Profile --> User\n    Profile --> Achievement\n    Profile --> Setting\n\n    Star --> UI\n    Card --> UI\n    Compass --> UI\n    Direction --> UI\n    Dynamic --> UI\n    Expert --> UI\n    User --> UI\n    Achievement --> UI\n    Setting --> UI\n\n    App --> Main\n    Divination --> Fallback\n    FengShui --> Fallback\n    Community --> Fallback\n\n    classDef domain fill:#f9f9f9,stroke:#333,stroke-width:2px\n    classDef subdomain fill:#e6f3ff,stroke:#0066cc,stroke-width:1px\n    classDef ui fill:#e8f5e8,stroke:#2e7d32,stroke-width:1px\n    classDef base fill:#fff3e0,stroke:#ff8f00,stroke-width:1px\n\n    class App domain\n    class Divination,FengShui,Community,Profile domain\n    class Star,Card,Compass,Direction,Dynamic,Expert,User,Achievement,Setting subdomain\n    class UI,Button,CardUI,Input,Progress,Dialog,Dropdown,Tabs ui\n    class Fallback,Utils,Main base\n```\n\n### 3.3 存储设计\n\n当前前端应用的存储设计主要包含：\n- **本地状态存储**：React Hooks管理的组件状态\n- **会话存储**：浏览器Session Storage\n- **本地存储**：浏览器Local Storage（用户偏好设置、缓存数据）\n- **临时数据**：组件生命周期内的临时数据\n\n### 3.4 领域模块间通信\n\n#### 3.4.1 通信机制\n- **状态传递**：通过Props进行父子组件间的状态传递\n- **事件回调**：子组件通过回调函数向父组件传递事件\n- **全局状态**：通过React Context进行跨组件状态共享\n- **路由参数**：通过URL参数进行页面间数据传递\n\n#### 3.4.2 依赖关系\n- **UI组件支撑域**被所有业务领域依赖\n- **应用导航**依赖所有业务领域进行页面渲染\n- **业务领域间**通过应用层进行间接通信\n\n## 4. 组件视图 (Component View)\n\n### 4.1 核心功能组件\n\n#### 4.1.1 App组件（应用主容器）\n- **职责**：应用主容器，管理页面导航和状态\n- **功能**：底部导航栏管理、页面路由切换、激活状态维护\n- **依赖**：DivinationPage.tsx, FengShuiPage.tsx, CommunityPage.tsx, ProfilePage.tsx\n- **技术实现**：React函数组件 + useState + useEffect\n\n#### 4.1.2 DivinationPage组件（占卜页面）\n- **职责**：占卜功能模块的主容器\n- **功能**：星座运势展示、卡牌占卜服务、占卜结果呈现\n- **子组件**：星座选择器、运势进度条、占卜卡牌网格\n- **技术实现**：React函数组件 + UI组件库\n\n#### 4.1.3 FengShuiPage组件（风水页面）\n- **职责**：风水功能模块的主容器\n- **功能**：风水罗盘展示、方位运势查询、风水建议提供\n- **子组件**：罗盘图像、方位按钮、风水信息展示\n- **技术实现**：React函数组件 + UI组件库\n\n#### 4.1.4 CommunityPage组件（社区页面）\n- **职责**：社区功能模块的主容器\n- **功能**：社区动态展示、达人咨询、话题讨论\n- **子组件**：标签页切换器、话题列表、达人列表\n- **技术实现**：React函数组件 + UI组件库\n\n#### 4.1.5 ProfilePage组件（个人中心页面）\n- **职责**：个人中心功能模块的主容器\n- **功能**：用户信息展示、成就统计、功能设置\n- **子组件**：用户头像、统计数据、成就列表、功能菜单\n- **技术实现**：React函数组件 + UI组件库\n\n### 4.2 技术支撑组件\n\n#### 4.2.1 UI组件库\n- **Button组件**：按钮交互组件，支持多种样式和状态\n- **Card组件**：内容展示卡片组件，支持标题、内容、操作区域\n- **Input组件**：输入框组件，支持验证和样式定制\n- **Progress组件**：进度条组件，用于展示运势进度等\n- **Dialog组件**：对话框组件，用于模态交互\n- **Dropdown组件**：下拉菜单组件，用于选项选择\n- **Tabs组件**：标签页组件，用于内容切换\n\n#### 4.2.2 基础支撑组件\n- **ImageWithFallback组件**：图片组件，支持加载失败时的备用显示\n- **utils.ts**：工具函数库，包含通用工具函数\n- **main.tsx**：应用启动入口，负责React应用渲染\n\n### 4.3 组件职责划分\n\n```mermaid\ngraph LR\n    subgraph \"应用层组件\"\n        App[App.tsx<br/>应用容器]\n        Main[main.tsx<br/>启动入口]\n    end\n\n    subgraph \"业务层组件\"\n        Divination[DivinationPage.tsx<br/>占卜页面]\n        FengShui[FengShuiPage.tsx<br/>风水页面]\n        Community[CommunityPage.tsx<br/>社区页面]\n        Profile[ProfilePage.tsx<br/>个人中心]\n    end\n\n    subgraph \"UI组件层\"\n        Button[Button组件<br/>按钮]\n        Card[Card组件<br/>卡片]\n        Input[Input组件<br/>输入框]\n        Progress[Progress组件<br/>进度条]\n        Dialog[Dialog组件<br/>对话框]\n        Dropdown[Dropdown组件<br/>下拉菜单]\n        Tabs[Tabs组件<br/>标签页]\n    end\n\n    subgraph \"基础组件层\"\n        Fallback[ImageWithFallback<br/>图片组件]\n        Utils[utils.ts<br/>工具函数]\n    end\n\n    App --> Divination\n    App --> FengShui\n    App --> Community\n    App --> Profile\n    App --> Main\n\n    Divination --> Button\n    Divination --> Card\n    Divination --> Progress\n    Divination --> Fallback\n\n    FengShui --> Card\n    FengShui --> Fallback\n\n    Community --> Card\n    Community --> Input\n    Community --> Tabs\n\n    Profile --> Card\n    Profile --> Progress\n\n    classDef app fill:#e1f5fe\n    classDef business fill:#f3e5f5\n    classDef ui fill:#e8f5e8\n    classDef base fill:#fff3e0\n\n    class App,Main app\n    class Divination,FengShui,Community,Profile business\n    class Button,Card,Input,Progress,Dialog,Dropdown,Tabs ui\n    class Fallback,Utils base\n```\n\n### 4.4 组件交互关系\n\n#### 4.4.1 数据流向\n- **用户操作** → **UI组件** → **业务组件** → **应用容器** → **页面渲染**\n- **API调用** → **业务组件** → **UI组件** → **用户界面**\n\n#### 4.4.2 事件处理\n- **点击事件**：用户点击 → 组件处理 → 状态更新 → 界面刷新\n- **输入事件**：用户输入 → 组件验证 → 数据处理 → 状态同步\n- **导航事件**：导航点击 → App组件 → 页面切换 → 状态重置\n\n## 5. 关键流程 (Key Processes)\n\n### 5.1 核心功能流程\n\n#### 5.1.1 应用主流程\n用户打开应用后，通过底部导航栏在占卜、风水、社区和个人中心四大功能模块间切换，每个模块提供不同的神秘学服务体验。\n\n```mermaid\ngraph TD\n    A[用户打开应用] --> B[App组件渲染]\n    B --> C[显示底部导航栏]\n    C --> D[用户选择功能模块]\n    D --> E{选择模块}\n    E -->|占卜| F[渲染占卜页面]\n    E -->|风水| G[渲染风水页面]\n    E -->|社区| H[渲染社区页面]\n    E -->|个人中心| I[渲染个人中心页面]\n    F --> J[用户使用占卜服务]\n    G --> K[用户使用风水服务]\n    H --> L[用户浏览社区内容]\n    I --> M[用户查看个人信息]\n    J --> C\n    K --> C\n    L --> C\n    M --> C\n```\n\n#### 5.1.2 占卜服务流程\n用户在占卜页面选择星座，查看今日运势，进行卡牌占卜的过程。\n\n```mermaid\ngraph TD\n    A[用户进入占卜页面] --> B[显示星座选择器]\n    B --> C[用户选择星座]\n    C --> D[展示今日运势信息]\n    D --> E[显示占卜卡牌网格]\n    E --> F{用户操作}\n    F -->|查看运势| G[显示详细运势]\n    F -->|进行占卜| H[选择占卜卡牌]\n    G --> I[返回占卜页面]\n    H --> J[显示占卜结果]\n    J --> I\n```\n\n#### 5.1.3 风水咨询流程\n用户在风水页面查看罗盘，选择不同方位，获取该方位的五行属性和风水建议。\n\n```mermaid\ngraph TD\n    A[用户进入风水页面] --> B[显示罗盘图像]\n    B --> C[显示八方位按钮]\n    C --> D[用户选择方位]\n    D --> E[显示该方位信息]\n    E --> F[展示五行属性]\n    F --> G[提供风水建议]\n    G --> H{用户操作}\n    H -->|选择其他方位| I[返回选择方位]\n    H -->|返回| J[退出风水页面]\n    I --> D\n    J --> A\n```\n\n#### 5.1.4 社区互动流程\n用户在社区页面通过标签页切换查看热门话题和达人咨询，参与社区互动。\n\n```mermaid\ngraph TD\n    A[用户进入社区页面] --> B[显示标签页切换器]\n    B --> C{选择标签页}\n    C -->|社区动态| D[展示热门话题列表]\n    C -->|达人咨询| E[展示达人列表]\n    D --> F[用户浏览帖子]\n    E --> G[用户查看达人信息]\n    F --> H{用户操作}\n    G --> I{用户操作}\n    H -->|查看帖子| J[进入帖子详情]\n    H -->|返回| K[返回社区页面]\n    I -->|发起咨询| L[进入咨询页面]\n    I -->|返回| K\n    J --> K\n    L --> K\n```\n\n#### 5.1.5 个人中心流程\n用户在个人中心页面查看个人信息、统计数据、成就系统，并进行各种系统设置。\n\n```mermaid\ngraph TD\n    A[用户进入个人中心] --> B[显示用户信息]\n    B --> C[展示统计数据]\n    C --> D[显示成就系统]\n    D --> E[显示功能菜单]\n    E --> F{用户操作}\n    F -->|查看成就| G[浏览成就列表]\n    F -->|系统设置| H[进入设置页面]\n    F -->|退出登录| I[确认退出]\n    F -->|其他功能| J[进入相应功能]\n    G --> K[返回个人中心]\n    H --> K\n    I --> L[退出应用]\n    J --> K\n    K --> A\n```\n\n### 5.2 技术处理流程\n\n#### 5.2.1 组件渲染流程\n1. **应用启动**：main.tsx启动React应用\n2. **容器渲染**：App.tsx渲染应用主容器\n3. **导航初始化**：底部导航栏初始化\n4. **页面渲染**：根据当前激活标签渲染对应页面\n5. **组件挂载**：页面组件及其子组件挂载\n6. **状态初始化**：组件状态初始化\n7. **UI更新**：界面渲染完成\n\n#### 5.2.2 状态管理流程\n1. **状态定义**：在组件中定义useState状态\n2. **状态更新**：通过事件处理器更新状态\n3. **状态传播**：状态变化触发组件重新渲染\n4. **UI同步**：界面与状态保持同步\n5. **副作用处理**：useEffect处理副作用\n\n### 5.3 数据流转路径\n\n#### 5.3.1 用户数据流转\n- **用户输入** → **组件状态** → **业务逻辑** → **UI展示**\n- **API响应** → **组件状态** → **UI更新** → **用户反馈**\n\n#### 5.3.2 业务数据流转\n- **占卜请求** → **占卜算法** → **占卜结果** → **UI展示**\n- **风水查询** → **风水数据** → **风水建议** → **UI展示**\n- **社区内容** → **内容管理** → **社区展示** → **用户互动**\n\n### 5.4 异常处理机制\n\n#### 5.4.1 网络异常处理\n- **请求失败**：显示错误提示，提供重试机制\n- **超时处理**：设置合理的超时时间，避免长时间等待\n- **离线支持**：缓存关键数据，支持离线浏览\n\n#### 5.4.2 用户输入验证\n- **表单验证**：实时验证用户输入，提供即时反馈\n- **边界检查**：验证输入数据的合理范围\n- **错误提示**：友好的错误提示信息\n\n## 6. 技术实现 (Technical Implementation)\n\n### 6.1 核心模块实现\n\n#### 6.1.1 占卜领域实现\n\n**星座运势模块**：\n- **数据结构**：星座运势数据包含综合评分、健康、爱情、事业、财富四个维度\n- **UI实现**：使用Progress组件展示各维度进度条\n- **交互逻辑**：星座选择器支持星座切换，实时更新运势信息\n\n**卡牌占卜模块**：\n- **网格布局**：使用Grid布局展示占卜卡牌\n- **神秘之书**：提供占卜服务入口，支持多种占卜类型\n- **结果展示**：占卜结果以卡片形式展示，包含详细解释\n\n#### 6.1.2 风水领域实现\n\n**罗盘展示模块**：\n- **图像展示**：使用ImageWithFallback组件展示风水罗盘\n- **响应式设计**：适配不同屏幕尺寸，保持罗盘比例\n- **交互设计**：支持点击选择不同方位\n\n**方位运势模块**：\n- **八方位布局**：使用Flex布局展示八个方位按钮\n- **风水属性**：展示五行属性、方位特点、摆放建议\n- **动态更新**：根据选择方位动态更新展示内容\n\n#### 6.1.3 社区领域实现\n\n**社区动态模块**：\n- **标签页切换**：使用Tabs组件实现动态切换\n- **内容展示**：使用Card组件展示话题和帖子\n- **列表渲染**：支持滚动加载更多内容\n\n**达人咨询模块**：\n- **达人列表**：展示达人头像、简介、评分\n- **咨询入口**：提供一键咨询功能\n- **专家分类**：按专业领域分类展示达人\n\n#### 6.1.4 个人中心实现\n\n**用户信息模块**：\n- **头像展示**：使用圆形头像组件\n- **等级系统**：展示用户等级和经验值进度\n- **个人信息**：展示用户名、简介等基本信息\n\n**成就统计模块**：\n- **统计数据**：展示占卜次数、社区活跃度等\n- **成就系统**：展示已解锁和未解锁成就\n- **进度追踪**：实时更新用户成长进度\n\n### 6.2 关键算法设计\n\n#### 6.2.1 占卜算法\n- **星座运势算法**：基于用户星座和当前日期计算运势\n- **卡牌占卜算法**：随机选择卡牌并生成占卜结果\n- **风水方位算法**：根据当前时间和方位计算风水属性\n\n#### 6.2.2 UI渲染算法\n- **响应式布局算法**：根据屏幕尺寸动态调整组件布局\n- **性能优化算法**：使用React.memo避免不必要的重渲染\n- **懒加载算法**：按需加载组件和数据，提升性能\n\n### 6.3 数据结构设计\n\n#### 6.3.1 用户数据结构\n```typescript\ninterface User {\n  id: string;\n  username: string;\n  avatar: string;\n  level: number;\n  experience: number;\n  totalExperience: number;\n  achievements: Achievement[];\n  statistics: UserStatistics;\n}\n\ninterface UserStatistics {\n  divinationCount: number;\n  communityPosts: number;\n  fengShuiConsultations: number;\n  communityEngagement: number;\n}\n```\n\n#### 6.3.2 占卜数据结构\n```typescript\ninterface DivinationResult {\n  id: string;\n  type: DivinationType;\n  date: Date;\n  result: string;\n  interpretation: string;\n  luckyNumbers: number[];\n  color: string;\n  mood: string;\n}\n\ninterface StarSignFortune {\n  sign: string;\n  overall: number;\n  health: number;\n  love: number;\n  career: number;\n  wealth: number;\n  description: string;\n}\n```\n\n#### 6.3.3 风水数据结构\n```typescript\ninterface FengShuiDirection {\n  name: string;\n  element: Element;\n  luckyColors: string[];\n  luckyNumbers: number[];\n  direction: string;\n  advice: string;\n  compatibility: string[];\n}\n\nenum Element {\n  WOOD = 'wood',\n  FIRE = 'fire',\n  EARTH = 'earth',\n  METAL = 'metal',\n  WATER = 'water'\n}\n```\n\n### 6.4 性能优化策略\n\n#### 6.4.1 组件优化\n- **React.memo**：对纯展示组件使用memo进行性能优化\n- **useCallback**：对事件处理器使用useCallback避免重复创建\n- **useMemo**：对计算密集型数据使用useMemo缓存结果\n\n#### 6.4.2 渲染优化\n- **虚拟滚动**：对长列表使用虚拟滚动技术\n- **懒加载**：按需加载组件和数据\n- **代码分割**：使用React.lazy进行代码分割\n\n#### 6.4.3 网络优化\n- **请求缓存**：对静态数据进行缓存\n- **预加载**：预加载关键资源\n- **压缩优化**：对图片和资源进行压缩\n\n## 7. 部署架构 (Deployment Architecture)\n\n### 7.1 运行环境要求\n\n#### 7.1.1 客户端环境\n- **浏览器支持**：现代浏览器（Chrome 80+, Firefox 75+, Safari 13+）\n- **移动端支持**：iOS 13+, Android 8+\n- **屏幕分辨率**：支持主流移动设备分辨率\n- **网络要求**：支持4G/5G/WiFi网络连接\n\n#### 7.1.2 开发环境\n- **Node.js**：16.0+版本\n- **npm/yarn**：包管理工具\n- **TypeScript**：4.0+版本\n- **构建工具**：Vite 4.0+\n\n### 7.2 部署拓扑结构\n\n```mermaid\ngraph TB\n    subgraph \"CDN网络\"\n        CDN[CDN节点]\n        Cache[缓存服务器]\n    end\n\n    subgraph \"前端应用服务器\"\n        FE1[前端应用实例1]\n        FE2[前端应用实例2]\n        FE3[前端应用实例3]\n    end\n\n    subgraph \"负载均衡\"\n        LB[负载均衡器]\n    end\n\n    subgraph \"后端服务\"\n        API[API网关]\n        AUTH[认证服务]\n        DATA[数据服务]\n        CACHE[缓存服务]\n    end\n\n    subgraph \"监控系统\"\n        MON[监控平台]\n        LOG[日志系统]\n        APM[APM系统]\n    end\n\n    User[用户设备] --> CDN\n    CDN --> LB\n    LB --> FE1\n    LB --> FE2\n    LB --> FE3\n\n    FE1 --> API\n    FE2 --> API\n    FE3 --> API\n\n    API --> AUTH\n    API --> DATA\n    API --> CACHE\n\n    FE1 --> MON\n    FE2 --> MON\n    FE3 --> MON\n    API --> MON\n\n    classDef frontend fill:#e8f5e8\n    classDef backend fill:#e3f2fd\n    classDef network fill:#fff3e0\n    classDef monitor fill:#fce4ec\n\n    class FE1,FE2,FE3 frontend\n    class API,AUTH,DATA,CACHE backend\n    class CDN,LB,CACHE network\n    class MON,LOG,APM monitor\n```\n\n### 7.3 扩展性设计\n\n#### 7.3.1 水平扩展\n- **前端应用**：支持多实例部署，通过负载均衡分发请求\n- **CDN网络**：支持全球节点部署，提升访问速度\n- **缓存系统**：支持分布式缓存，提高数据访问效率\n\n#### 7.3.2 垂直扩展\n- **组件化设计**：支持功能模块独立扩展\n- **插件机制**：预留插件接口，支持功能扩展\n- **API设计**：RESTful API设计，支持版本管理\n\n### 7.4 监控与运维\n\n#### 7.4.1 性能监控\n- **页面加载时间**：监控首屏加载时间、完全加载时间\n- **用户交互性能**：监控点击响应时间、页面切换时间\n- **资源使用情况**：监控内存使用、CPU占用率\n\n#### 7.4.2 错误监控\n- **JavaScript错误**：捕获并上报前端JavaScript错误\n- **网络请求错误**：监控API请求失败情况\n- **用户行为分析**：分析用户使用路径和异常行为\n\n#### 7.4.3 运维自动化\n- **CI/CD流水线**：自动化构建、测试、部署流程\n- **健康检查**：定期检查应用健康状态\n- **自动扩容**：根据负载情况自动调整实例数量\n\n### 7.5 安全设计\n\n#### 7.5.1 数据安全\n- **HTTPS加密**：所有数据传输使用HTTPS加密\n- **输入验证**：严格验证用户输入，防止XSS攻击\n- **数据脱敏**：敏感信息进行脱敏处理\n\n#### 7.5.2 访问控制\n- **身份认证**：集成身份认证服务\n- **权限管理**：基于角色的访问控制\n- **会话管理**：安全的会话管理机制\n\n#### 7.5.3 安全监控\n- **异常检测**：监控异常访问行为\n- **安全审计**：记录安全相关操作日志\n- **漏洞扫描**：定期进行安全漏洞扫描\n\n---\n\n**文档生成时间**：__CURRENT_UTC_TIME__  \n**时间戳**：__CURRENT_TIMESTAMP__\n\n本架构文档详细描述了占卜应用的完整架构设计，涵盖了从系统上下文到部署架构的各个层面，为开发团队提供了清晰的架构指导和技术参考。",
  "timestamp": 1763519971,
  "prompt_hash": "96cfcb368d26c38df521fd656008fb01",
  "token_usage": {
    "input_tokens": 7574,
    "output_tokens": 6397,
    "total_tokens": 13971
  },
  "model_name": null
}